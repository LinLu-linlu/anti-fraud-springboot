import{a as x}from"./axios-B4uVmeYG.js";import{d as z,b as P,r,e as p,o as $,z as q,k as a,h as k,j as e,l as c,i as T,u as l,D as I,y as G,f as W,t as N,F as J}from"./index-Da-BD_yu.js";const Q={class:"dialog-footer"},A="120px",Y=z({__name:"UserDialog",props:["userId"],emits:["refresh"],setup(O,{expose:v,emit:R}){const _=P().appContext.config.globalProperties.$CONST;let i=r(!1);const C=O;let t=r({id:null,username:"",nickname:"",score:null});const E=R,m=()=>{x.post(_.AXIOS_API_FRONT+"/user/update",{id:t.value.id,username:t.value.username,nickname:t.value.nickname,score:t.value.score},{headers:{"Content-Type":"application/json"}}).then(y=>{i.value=!1})};v({dialogFormVisible:i});const f=()=>{x.get(_.AXIOS_API_FRONT+"/user/selectById",{params:{id:C.userId}}).then(y=>{t.value=y.data.data})},V=()=>{E("refresh"),t=r({id:null,username:"",nickname:"",score:null})};return(y,n)=>{const g=p("el-form-item"),b=p("el-form"),U=p("el-button"),w=p("el-dialog");return $(),q(w,{modelValue:l(i),"onUpdate:modelValue":n[4]||(n[4]=d=>T(i)?i.value=d:i=d),title:"更新用户信息",width:"500",onOpen:f,onClose:V},{footer:a(()=>[k("div",Q,[e(U,{onClick:n[3]||(n[3]=d=>T(i)?i.value=!1:i=!1)},{default:a(()=>[c("取消")]),_:1}),e(U,{type:"primary",onClick:m},{default:a(()=>[c(" 更新 ")]),_:1})])]),default:a(()=>[e(b,{model:l(t)},{default:a(()=>[e(g,{label:l(_).USER_USERNAME,"label-width":A},{default:a(()=>[e(l(I),{modelValue:l(t).username,"onUpdate:modelValue":n[0]||(n[0]=d=>l(t).username=d),autocomplete:"off",style:{width:"300px"}},null,8,["modelValue"])]),_:1},8,["label"]),e(g,{label:l(_).USER_NICKNAME,"label-width":A},{default:a(()=>[e(l(I),{modelValue:l(t).nickname,"onUpdate:modelValue":n[1]||(n[1]=d=>l(t).nickname=d),autocomplete:"off",style:{width:"300px"}},null,8,["modelValue"])]),_:1},8,["label"]),e(g,{label:l(_).USER_SCORE,"label-width":A},{default:a(()=>[e(l(I),{modelValue:l(t).score,"onUpdate:modelValue":n[2]||(n[2]=d=>l(t).score=d),autocomplete:"off",style:{width:"300px"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),Z={style:{"margin-top":"40px"}},ee=k("span",null,"确定封禁该账号吗？",-1),le={class:"dialog-footer"},oe=z({__name:"UserPage",setup(O){const v=r(1),R=r("default"),_=r(!1),i=r(!1),C=r(""),t=r(!1),E=r(null),m=P().appContext.config.globalProperties.$CONST;var f=r(),V=r();const y=(s,u)=>u.state===s;let n=r(),g=r();const b=()=>{x.post(m.AXIOS_API_FRONT+"/user/findPage",{currentPage:v.value,pageSize:10,queryString:C.value},{headers:{"Content-Type":"application/json"}}).then(s=>{n.value=s.data.data,g.value=s.data.total})};G(()=>{b(),console.log(n)});const U=s=>{f.value=s,E.value.dialogFormVisible=!0},w=(s,u)=>{f.value=s,V.value=u,t.value=!0},d=s=>{console.log(`${s} items per page`)},F=s=>{console.log(`current page: ${s}`)},D=()=>{b()},B=()=>{x.get(m.AXIOS_API_FRONT+(V.value?"/user/unBanUser":"/user/banUser"),{params:{id:f.value}}).then(s=>{b()}),t.value=!1};return(s,u)=>{const M=p("el-input"),S=p("el-button"),h=p("el-table-column"),j=p("el-tag"),X=p("el-table"),L=p("el-pagination"),H=p("el-dialog");return $(),W(J,null,[k("h1",null,N(l(m).USER_MANAGE),1),k("div",Z,[e(M,{modelValue:C.value,"onUpdate:modelValue":u[0]||(u[0]=o=>C.value=o),style:{width:"240px"},size:"small",placeholder:l(m).USER_SEARCH_PLACEHOLDER,clearable:""},null,8,["modelValue","placeholder"]),e(S,{type:"primary",style:{"margin-left":"20px"},size:"small",onClick:D},{default:a(()=>[c("搜索")]),_:1})]),e(X,{data:l(n),height:"500",style:{width:"100%","margin-top":"30px"},"table-layout":"auto"},{default:a(()=>[e(h,{prop:"username",label:l(m).USER_USERNAME},null,8,["label"]),e(h,{prop:"nickname",label:l(m).USER_NICKNAME},null,8,["label"]),e(h,{prop:"score",label:l(m).USER_SCORE},null,8,["label"]),e(h,{prop:"state",label:l(m).USER_STATE,width:"100",filters:[{text:"正常",value:0},{text:"封号",value:1}],"filter-method":y,"filter-placement":"bottom-end"},{default:a(o=>[e(j,{type:o.row.state===0?"primary":"danger","disable-transitions":""},{default:a(()=>[c(N(o.row.state==0?"正常":"封号"),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e(h,{prop:"operations",label:"操作"},{default:a(o=>[e(S,{type:"primary",size:"small",onClick:K=>U(o.row.id)},{default:a(()=>[c(" 修改 ")]),_:2},1032,["onClick"]),e(S,{size:"small",type:o.row.state===0?"danger":"warning",onClick:K=>w(o.row.id,o.row.state)},{default:a(()=>[c(N(o.row.state===0?"封号":"解封"),1)]),_:2},1032,["type","onClick"])]),_:1})]),_:1},8,["data"]),e(L,{"current-page":v.value,"onUpdate:currentPage":u[1]||(u[1]=o=>v.value=o),"page-size":10,size:R.value,disabled:i.value,background:_.value,layout:"total, prev, pager, next,jumper",total:l(g),onSizeChange:d,onCurrentChange:F,style:{"margin-top":"30px"}},null,8,["current-page","size","disabled","background","total"]),e(H,{modelValue:t.value,"onUpdate:modelValue":u[3]||(u[3]=o=>t.value=o),title:"封号确认",width:"500","align-center":""},{footer:a(()=>[k("div",le,[e(S,{onClick:u[2]||(u[2]=o=>t.value=!1)},{default:a(()=>[c("取消")]),_:1}),e(S,{type:"danger",onClick:B},{default:a(()=>[c(" 封禁 ")]),_:1})])]),default:a(()=>[ee]),_:1},8,["modelValue"]),e(Y,{ref_key:"userDialog",ref:E,userId:l(f),onRefresh:b},null,8,["userId"])],64)}}});export{oe as default};
